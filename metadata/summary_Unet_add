Model: "Unet_add"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
DEPTH_input (InputLayer)        [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
RGB_input (InputLayer)          [(None, 512, 512, 3) 0                                            
__________________________________________________________________________________________________
dblock1_conv1 (Conv2D)          (None, 512, 512, 64) 1792        DEPTH_input[0][0]                
__________________________________________________________________________________________________
block1_conv1 (Conv2D)           (None, 512, 512, 64) 1792        RGB_input[0][0]                  
__________________________________________________________________________________________________
dblock1_conv2 (Conv2D)          (None, 512, 512, 64) 36928       dblock1_conv1[0][0]              
__________________________________________________________________________________________________
block1_conv2 (Conv2D)           (None, 512, 512, 64) 36928       block1_conv1[0][0]               
__________________________________________________________________________________________________
d_add (Add)                     (None, 512, 512, 64) 0           dblock1_conv2[0][0]              
                                                                 block1_conv2[0][0]               
__________________________________________________________________________________________________
block1_pool (MaxPooling2D)      (None, 256, 256, 64) 0           d_add[0][0]                      
__________________________________________________________________________________________________
dblock1_pool (MaxPooling2D)     (None, 256, 256, 64) 0           dblock1_conv2[0][0]              
__________________________________________________________________________________________________
block2_conv1 (Conv2D)           (None, 256, 256, 128 73856       block1_pool[0][0]                
__________________________________________________________________________________________________
dblock2_conv1 (Conv2D)          (None, 256, 256, 128 73856       dblock1_pool[0][0]               
__________________________________________________________________________________________________
block2_conv2 (Conv2D)           (None, 256, 256, 128 147584      block2_conv1[0][0]               
__________________________________________________________________________________________________
dblock2_conv2 (Conv2D)          (None, 256, 256, 128 147584      dblock2_conv1[0][0]              
__________________________________________________________________________________________________
d_add_1 (Add)                   (None, 256, 256, 128 0           dblock2_conv2[0][0]              
                                                                 block2_conv2[0][0]               
__________________________________________________________________________________________________
block2_pool (MaxPooling2D)      (None, 128, 128, 128 0           d_add_1[0][0]                    
__________________________________________________________________________________________________
dblock2_pool (MaxPooling2D)     (None, 128, 128, 128 0           dblock2_conv2[0][0]              
__________________________________________________________________________________________________
block3_conv1 (Conv2D)           (None, 128, 128, 256 295168      block2_pool[0][0]                
__________________________________________________________________________________________________
dblock3_conv1 (Conv2D)          (None, 128, 128, 256 295168      dblock2_pool[0][0]               
__________________________________________________________________________________________________
block3_conv2 (Conv2D)           (None, 128, 128, 256 590080      block3_conv1[0][0]               
__________________________________________________________________________________________________
dblock3_conv2 (Conv2D)          (None, 128, 128, 256 590080      dblock3_conv1[0][0]              
__________________________________________________________________________________________________
block3_conv3 (Conv2D)           (None, 128, 128, 256 590080      block3_conv2[0][0]               
__________________________________________________________________________________________________
dblock3_conv3 (Conv2D)          (None, 128, 128, 256 590080      dblock3_conv2[0][0]              
__________________________________________________________________________________________________
d_add_2 (Add)                   (None, 128, 128, 256 0           dblock3_conv3[0][0]              
                                                                 block3_conv3[0][0]               
__________________________________________________________________________________________________
block3_pool (MaxPooling2D)      (None, 64, 64, 256)  0           d_add_2[0][0]                    
__________________________________________________________________________________________________
dblock3_pool (MaxPooling2D)     (None, 64, 64, 256)  0           dblock3_conv3[0][0]              
__________________________________________________________________________________________________
block4_conv1 (Conv2D)           (None, 64, 64, 512)  1180160     block3_pool[0][0]                
__________________________________________________________________________________________________
dblock4_conv1 (Conv2D)          (None, 64, 64, 512)  1180160     dblock3_pool[0][0]               
__________________________________________________________________________________________________
block4_conv2 (Conv2D)           (None, 64, 64, 512)  2359808     block4_conv1[0][0]               
__________________________________________________________________________________________________
dblock4_conv2 (Conv2D)          (None, 64, 64, 512)  2359808     dblock4_conv1[0][0]              
__________________________________________________________________________________________________
block4_conv3 (Conv2D)           (None, 64, 64, 512)  2359808     block4_conv2[0][0]               
__________________________________________________________________________________________________
dblock4_conv3 (Conv2D)          (None, 64, 64, 512)  2359808     dblock4_conv2[0][0]              
__________________________________________________________________________________________________
d_add_3 (Add)                   (None, 64, 64, 512)  0           dblock4_conv3[0][0]              
                                                                 block4_conv3[0][0]               
__________________________________________________________________________________________________
dblock4_pool (MaxPooling2D)     (None, 32, 32, 512)  0           dblock4_conv3[0][0]              
__________________________________________________________________________________________________
block4_pool (MaxPooling2D)      (None, 32, 32, 512)  0           d_add_3[0][0]                    
__________________________________________________________________________________________________
dblock5_conv1 (Conv2D)          (None, 32, 32, 512)  2359808     dblock4_pool[0][0]               
__________________________________________________________________________________________________
block5_conv1 (Conv2D)           (None, 32, 32, 512)  2359808     block4_pool[0][0]                
__________________________________________________________________________________________________
dblock5_conv2 (Conv2D)          (None, 32, 32, 512)  2359808     dblock5_conv1[0][0]              
__________________________________________________________________________________________________
block5_conv2 (Conv2D)           (None, 32, 32, 512)  2359808     block5_conv1[0][0]               
__________________________________________________________________________________________________
dblock5_conv3 (Conv2D)          (None, 32, 32, 512)  2359808     dblock5_conv2[0][0]              
__________________________________________________________________________________________________
block5_conv3 (Conv2D)           (None, 32, 32, 512)  2359808     block5_conv2[0][0]               
__________________________________________________________________________________________________
d_add_4 (Add)                   (None, 32, 32, 512)  0           dblock5_conv3[0][0]              
                                                                 block5_conv3[0][0]               
__________________________________________________________________________________________________
block5_pool (MaxPooling2D)      (None, 16, 16, 512)  0           d_add_4[0][0]                    
__________________________________________________________________________________________________
bottleneck_upsample_ (UpSamplin (None, 32, 32, 512)  0           block5_pool[0][0]                
__________________________________________________________________________________________________
bottleneck_blk0_conv_ (Conv2D)  (None, 32, 32, 512)  2359808     bottleneck_upsample_[0][0]       
__________________________________________________________________________________________________
bottleneck_blk0_bn_ (BatchNorma (None, 32, 32, 512)  2048        bottleneck_blk0_conv_[0][0]      
__________________________________________________________________________________________________
bottleneck_blk0_activ_ (Activat (None, 32, 32, 512)  0           bottleneck_blk0_bn_[0][0]        
__________________________________________________________________________________________________
bottleneck_blk1_conv_ (Conv2D)  (None, 32, 32, 512)  2359808     bottleneck_blk0_activ_[0][0]     
__________________________________________________________________________________________________
bottleneck_blk1_bn_ (BatchNorma (None, 32, 32, 512)  2048        bottleneck_blk1_conv_[0][0]      
__________________________________________________________________________________________________
bottleneck_blk1_activ_ (Activat (None, 32, 32, 512)  0           bottleneck_blk1_bn_[0][0]        
__________________________________________________________________________________________________
decod1_upsample_ (UpSampling2D) (None, 64, 64, 512)  0           bottleneck_blk1_activ_[0][0]     
__________________________________________________________________________________________________
block4_conv3_concat_decod (Conc (None, 64, 64, 1024) 0           block4_conv3[0][0]               
                                                                 decod1_upsample_[0][0]           
__________________________________________________________________________________________________
decod1_blk1_conv_ (Conv2D)      (None, 64, 64, 256)  2359552     block4_conv3_concat_decod[0][0]  
__________________________________________________________________________________________________
decod1_blk1_bn_ (BatchNormaliza (None, 64, 64, 256)  1024        decod1_blk1_conv_[0][0]          
__________________________________________________________________________________________________
decod1_blk1_activ_ (Activation) (None, 64, 64, 256)  0           decod1_blk1_bn_[0][0]            
__________________________________________________________________________________________________
decod1_blk2_conv_ (Conv2D)      (None, 64, 64, 256)  590080      decod1_blk1_activ_[0][0]         
__________________________________________________________________________________________________
decod1_blk2_bn_ (BatchNormaliza (None, 64, 64, 256)  1024        decod1_blk2_conv_[0][0]          
__________________________________________________________________________________________________
decod1_blk2_activ_ (Activation) (None, 64, 64, 256)  0           decod1_blk2_bn_[0][0]            
__________________________________________________________________________________________________
decod2_upsample_ (UpSampling2D) (None, 128, 128, 256 0           decod1_blk2_activ_[0][0]         
__________________________________________________________________________________________________
block3_conv3_concat_decod (Conc (None, 128, 128, 512 0           block3_conv3[0][0]               
                                                                 decod2_upsample_[0][0]           
__________________________________________________________________________________________________
decod2_blk1_conv_ (Conv2D)      (None, 128, 128, 128 589952      block3_conv3_concat_decod[0][0]  
__________________________________________________________________________________________________
decod2_blk1_bn_ (BatchNormaliza (None, 128, 128, 128 512         decod2_blk1_conv_[0][0]          
__________________________________________________________________________________________________
decod2_blk1_activ_ (Activation) (None, 128, 128, 128 0           decod2_blk1_bn_[0][0]            
__________________________________________________________________________________________________
decod2_blk2_conv_ (Conv2D)      (None, 128, 128, 128 147584      decod2_blk1_activ_[0][0]         
__________________________________________________________________________________________________
decod2_blk2_bn_ (BatchNormaliza (None, 128, 128, 128 512         decod2_blk2_conv_[0][0]          
__________________________________________________________________________________________________
decod2_blk2_activ_ (Activation) (None, 128, 128, 128 0           decod2_blk2_bn_[0][0]            
__________________________________________________________________________________________________
decod3_upsample_ (UpSampling2D) (None, 256, 256, 128 0           decod2_blk2_activ_[0][0]         
__________________________________________________________________________________________________
block2_conv2_concat_decod (Conc (None, 256, 256, 256 0           block2_conv2[0][0]               
                                                                 decod3_upsample_[0][0]           
__________________________________________________________________________________________________
decod3_blk1_conv_ (Conv2D)      (None, 256, 256, 64) 147520      block2_conv2_concat_decod[0][0]  
__________________________________________________________________________________________________
decod3_blk1_bn_ (BatchNormaliza (None, 256, 256, 64) 256         decod3_blk1_conv_[0][0]          
__________________________________________________________________________________________________
decod3_blk1_activ_ (Activation) (None, 256, 256, 64) 0           decod3_blk1_bn_[0][0]            
__________________________________________________________________________________________________
decod3_blk2_conv_ (Conv2D)      (None, 256, 256, 64) 36928       decod3_blk1_activ_[0][0]         
__________________________________________________________________________________________________
decod3_blk2_bn_ (BatchNormaliza (None, 256, 256, 64) 256         decod3_blk2_conv_[0][0]          
__________________________________________________________________________________________________
decod3_blk2_activ_ (Activation) (None, 256, 256, 64) 0           decod3_blk2_bn_[0][0]            
__________________________________________________________________________________________________
decod4_upsample_ (UpSampling2D) (None, 512, 512, 64) 0           decod3_blk2_activ_[0][0]         
__________________________________________________________________________________________________
d_add_concat_decod (Concatenate (None, 512, 512, 128 0           d_add[0][0]                      
                                                                 decod4_upsample_[0][0]           
__________________________________________________________________________________________________
decod4_blk1_conv_ (Conv2D)      (None, 512, 512, 32) 36896       d_add_concat_decod[0][0]         
__________________________________________________________________________________________________
decod4_blk1_bn_ (BatchNormaliza (None, 512, 512, 32) 128         decod4_blk1_conv_[0][0]          
__________________________________________________________________________________________________
decod4_blk1_activ_ (Activation) (None, 512, 512, 32) 0           decod4_blk1_bn_[0][0]            
__________________________________________________________________________________________________
decod4_blk2_conv_ (Conv2D)      (None, 512, 512, 32) 9248        decod4_blk1_activ_[0][0]         
__________________________________________________________________________________________________
decod4_blk2_bn_ (BatchNormaliza (None, 512, 512, 32) 128         decod4_blk2_conv_[0][0]          
__________________________________________________________________________________________________
decod4_blk2_activ_ (Activation) (None, 512, 512, 32) 0           decod4_blk2_bn_[0][0]            
__________________________________________________________________________________________________
decod5_blk1_conv_ (Conv2D)      (None, 512, 512, 16) 4624        decod4_blk2_activ_[0][0]         
__________________________________________________________________________________________________
decod5_blk1_bn_ (BatchNormaliza (None, 512, 512, 16) 64          decod5_blk1_conv_[0][0]          
__________________________________________________________________________________________________
decod5_blk1_activ_ (Activation) (None, 512, 512, 16) 0           decod5_blk1_bn_[0][0]            
__________________________________________________________________________________________________
decod5_blk2_conv_ (Conv2D)      (None, 512, 512, 16) 2320        decod5_blk1_activ_[0][0]         
__________________________________________________________________________________________________
decod5_blk2_bn_ (BatchNormaliza (None, 512, 512, 16) 64          decod5_blk2_conv_[0][0]          
__________________________________________________________________________________________________
decod5_blk2_activ_ (Activation) (None, 512, 512, 16) 0           decod5_blk2_bn_[0][0]            
__________________________________________________________________________________________________
output (Conv2D)                 (None, 512, 512, 1)  17          decod5_blk2_activ_[0][0]         
==================================================================================================
Total params: 38,081,777
Trainable params: 38,077,745
Non-trainable params: 4,032
__________________________________________________________________________________________________
